# TENG阵列多通道信号检测系统

## 项目简介

这是一个基于 PyQt5 开发的上位机软件，用于 TENG（摩擦纳米发电机）阵列的多通道信号检测。软件能够通过串口与硬件设备通信，实时采集多通道电压信号，并在图表中进行可视化显示。此外，软件还具备触摸点检测、像素地图和数字矩阵显示、测试数据生成以及数据导出等功能。

## 主要功能

*   **多通道信号采集**: 通过串口实时接收来自 TENG 阵列的电压信号。
*   **实时图表显示**: 使用 PyQtGraph 库将多通道电压信号以波形图的形式实时显示。
*   **触摸点检测**: 根据接收到的信号，检测 TENG 阵列上的触摸点。
*   **像素地图显示**: 在图形界面上以像素地图的形式直观显示触摸点的位置。
*   **数字矩阵显示**: 显示触摸点相关的数字信息（例如，触摸发生的时间）。
*   **测试数据生成**: 提供生成模拟测试数据的功能，方便在没有硬件的情况下进行软件测试。
*   **数据导出**: 支持将采集到的数据导出为 CSV 文件，便于后续分析。
*   **串口通信配置**: 提供配置串口参数（波特率、数据位、停止位、奇偶校验、流控制）的界面。

## 安装依赖

在运行本软件之前，请确保您的系统已安装 Python 环境。然后，您可以通过以下命令安装项目所需的依赖库：

```bash
pip install -r requirements.txt
```

项目依赖包括：
*   `pyserial`: 用于串口通信。
*   `PyQt5`: 用于构建图形用户界面。
*   `pyqtgraph`: 用于高性能的数据绘图。
*   `numpy`: 用于潜在的数据处理和优化。

## 使用方法

1.  **连接硬件**: 将 TENG 阵列硬件设备通过串口连接到电脑。
2.  **运行软件**: 在项目根目录下运行主程序文件：
    ```bash
    python UpperComputer.py
    ```
3.  **配置串口**: 在软件界面左侧的控制面板中，选择正确的串口号和配置参数（波特率、数据位等），然后点击“连接”按钮。
4.  **数据采集与显示**: 成功连接串口后，软件将开始实时采集数据并在右侧的图表区域显示波形。
5.  **触摸点交互**: 如果硬件检测到触摸，相应的像素地图和数字矩阵将会更新。
6.  **测试数据**: 如果没有硬件，可以点击“生成测试数据”按钮来模拟数据采集和显示过程。
7.  **数据导出**: 点击“导出数据”按钮可以将采集到的数据保存为 CSV 文件。
8.  **复位和清空**: 使用“复位视图”按钮可以重置图表缩放和平移，使用“清空数据”按钮可以清除当前图表数据和像素地图/数字矩阵显示。

## 文件结构

### 主程序文件
- [`UpperComputer.py`](UpperComputer.py): 主窗口类 `MainWindow` 定义了 UI 并协调 `PlotManager` 和 `SerialManager`。

### 核心模块
#### 串口管理
- [`serial_manager.py`](serial_manager.py): 包含 `SerialManager` 类，负责串口连接、配置及状态管理。
- [`serial_handler.py`](serial_handler.py): 提供 `SerialThread` 线程类，用于异步读取串口数据。

#### 图表管理
- [`plot_manager.py`](plot_manager.py): 包含 `PlotManager` 类，负责管理图表更新、触摸点检测以及测试数据生成等功能。

### UI 模块
位于 `ui/` 子目录下：
- 控制面板 (`control_panel_ui.py`)
- 数据显示 (`data_display_ui.py`)
- 菜单栏 (`menu_bar_ui.py`)
- 像素地图 (`pixel_map_ui.py`)
- 状态栏 (`status_bar_ui.py`)

### 辅助模块
位于 `modules/` 子目录下：
- 数据导出 (`data_exporter.py`)
- 数据管理 (`data_manager.py`)
- 图表同步 (`plot_synchronizer.py`)
- 图表更新器 (`plot_updater.py`)
- 测试数据生成器 (`test_data_generator.py`)
- 触摸检测器 (`touch_detector.py`)

## 技术栈
- **语言**: Python
- **框架/库**:
  - `PyQt5`: 构建图形用户界面
  - `pyqtgraph`: 高性能绘图
  - `numpy`: 数据处理
  - `pyserial`: 串口通信

## 改进建议
1. **文档**: 当前 README 文件提供了良好的基础信息，但可以进一步补充每个模块的具体接口说明和设计意图。
2. **单元测试**: 添加针对核心功能的单元测试，确保长期维护中的稳定性。
3. **异常处理**: 在关键逻辑（如串口通信和数据解析）中增加更详细的错误日志记录。

## 作者

GQL

## 版本

V1.1